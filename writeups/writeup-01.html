<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="nmap network reconnaissance against Metasploitable2 revealing 23 open ports, vulnerable services, Wazuh detection, and hardening recommendations.">
    <title>nmap Network Reconnaissance | jellybeansontoasties Home Lab</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <nav>
        <ul>
            <li><a href="../index.html">Home</a></li>
            <li><a href="../about.html">About</a></li>
            <li><a href="../lab-setup.html">Lab Setup</a></li>
            <li><a href="writeup-01.html">Writeups</a></li>
            <li><a href="https://github.com/Jellybeansontoasties">GitHub</a></li>
        </ul>
    </nav>

    <main>
        <h1>nmap Network Reconnaissance</h1>
        <p class="tagline">Full service and OS detection scan against Metasploitable2 (192.168.100.20) from Kali (192.168.100.10)</p>

        <div class="writeup-section">
            <h3>Summary</h3>
            <p>From the Kali attacker VM at 192.168.100.10, a full nmap service version and OS detection scan was run against the Metasploitable2 target at 192.168.100.20 on an isolated KVM homelab network. The scan completed in roughly half a minute and identified 23 open TCP ports exposing a wide attack surface of outdated, misconfigured, and intentionally vulnerable services.</p>
            <ul>
                <li>Multiple remote access services exposed, including FTP, SSH, Telnet, rsh/rlogin, VNC, and X11.</li>
                <li>Legacy application protocols and weak cryptography such as SSLv2 on SMTP and ancient OpenSSH.</li>
                <li>Directly exposed databases (MySQL on 3306 and PostgreSQL on 5432) with no apparent network firewalling.</li>
                <li>Dangerous services like a root bindshell on 1524/tcp and Java RMI on 1099/tcp running without authentication.</li>
            </ul>
        </div>

        <div class="writeup-section">
            <h3>Attack Technique Used</h3>
            <p>The attack technique here is classic network reconnaissance using <code>nmap</code> with service version detection (<code>-sV</code>), default script scanning (<code>-sC</code>), and OS fingerprinting (<code>-O</code>). This is the first phase of nearly every penetration test: systematically mapping reachable ports, identifying running services and versions, and inferring the underlying operating system in order to prioritize exploitation paths.</p>
        </div>

        <div class="writeup-section">
            <h3>Steps to Reproduce</h3>
            <p><strong>Terminal:</strong> Kali SSH (<code>ssh owokali@192.168.100.10</code>)</p>
            <pre><code>sudo nmap -sV -sC -O 192.168.100.20 -oN scan_results.txt
cat scan_results.txt</code></pre>

            <p><strong>Complete findings from scan:</strong></p>
            <ul>
                <li><strong>Port 21/tcp:</strong> vsftpd 2.3.4 — anonymous FTP login allowed (FTP code 230), plaintext data connections, CVE-2011-2523 backdoor present.</li>
                <li><strong>Port 22/tcp:</strong> OpenSSH 4.7p1 Debian 8ubuntu1 — very old SSH daemon from 2008, only supports deprecated key algorithms.</li>
                <li><strong>Port 23/tcp:</strong> Linux telnetd — unencrypted remote access, all credentials and data sent in plaintext.</li>
                <li><strong>Port 25/tcp:</strong> Postfix smtpd — SSLv2 supported (broken cryptography, DROWN-vulnerable), certificate expired April 2010.</li>
                <li><strong>Port 53/tcp:</strong> ISC BIND 9.4.2 — outdated DNS server.</li>
                <li><strong>Port 80/tcp:</strong> Apache httpd 2.2.8 — legacy web server with multiple known CVEs.</li>
                <li><strong>Port 111/tcp:</strong> rpcbind — exposes NFS-related RPC services.</li>
                <li><strong>Ports 139/tcp and 445/tcp:</strong> Samba 3.0.20 — SMB signing disabled, enabling relay-style attacks.</li>
                <li><strong>Port 512/tcp:</strong> netkit-rsh rexecd — legacy remote execution service, no encryption.</li>
                <li><strong>Port 513/tcp:</strong> rlogin — unencrypted remote login.</li>
                <li><strong>Port 514/tcp:</strong> Netkit rshd — remote shell with no authentication or encryption.</li>
                <li><strong>Port 1099/tcp:</strong> Java RMI GNU Classpath grmiregistry — unauthenticated Java RMI registry, later used for remote code execution.</li>
                <li><strong>Port 1524/tcp:</strong> Metasploitable bindshell — preconfigured, unauthenticated root shell listener.</li>
                <li><strong>Port 2049/tcp:</strong> NFS v2–v4 — network file system exposed directly.</li>
                <li><strong>Port 2121/tcp:</strong> ProFTPD 1.3.1 — second FTP server instance.</li>
                <li><strong>Port 3306/tcp:</strong> MySQL 5.0.51a — database exposed to the network with no firewall controls.</li>
                <li><strong>Port 5432/tcp:</strong> PostgreSQL 8.3.0 — another database exposed directly to the network.</li>
                <li><strong>Port 5900/tcp:</strong> VNC protocol 3.3 — remote desktop protocol exposed.</li>
                <li><strong>Port 6000/tcp:</strong> X11 — display server exposed.</li>
                <li><strong>Port 6667/tcp:</strong> UnrealIRCd — IRC server that is also known to ship with a backdoor in some versions.</li>
                <li><strong>Port 8009/tcp:</strong> Apache JServ AJP — Java application server connector.</li>
                <li><strong>Port 8180/tcp:</strong> Apache Tomcat 5.5 — Java web application server.</li>
                <li><strong>OS detected:</strong> Linux kernel 2.6.9–2.6.33, roughly 2008-era; <strong>SMB security:</strong> message signing disabled (dangerous but default for this lab).</li>
            </ul>
        </div>

        <div class="writeup-section">
            <h3>Detection (Wazuh)</h3>
            <p>Network scanning generates a large volume of short-lived connection attempts across many ports in a very small time window. In a monitored environment, Wazuh can flag this behavior: rule 5712 (or equivalent) triggers on repeated connection attempts and clear port-scanning patterns. In this lab the Kali host at 192.168.100.10 connected to every port on 192.168.100.20 within approximately 34 seconds, which is a textbook nmap scan signature that would also be visible to a network IDS such as Snort or Suricata.</p>
        </div>

        <div class="writeup-section">
            <h3>Remediation</h3>
            <ul>
                <li>Disable or remove all unused services — the initial attack surface was 23 open ports; hardened internet-facing systems should typically expose only a small handful of required services.</li>
                <li>Place databases (MySQL on 3306 and PostgreSQL on 5432) behind network firewalls or on internal-only VLANs; databases should never be directly reachable from untrusted networks.</li>
                <li>Replace Telnet, rlogin, and rsh with SSH everywhere to eliminate plaintext remote-access protocols.</li>
                <li>Apply current security patches to the operating system and all services; the 2.6.x kernel and software versions from 2008 have hundreds of publicly documented vulnerabilities.</li>
                <li>Implement network segmentation so critical assets (databases, domain controllers, SIEM infrastructure) reside on separate VLANs from exposed services.</li>
                <li>Disable anonymous FTP access and review all FTP usage; prefer SFTP or other encrypted file transfer mechanisms.</li>
                <li>Retire SSLv2 and other obsolete cryptographic protocols; enforce TLS 1.2+ with modern cipher suites.</li>
            </ul>
        </div>

        <div class="writeup-section">
            <h3>MITRE ATT&amp;CK Mapping</h3>
            <p>TA0043 Reconnaissance, T1046 Network Service Discovery, T1595 Active Scanning.</p>
        </div>

        <div class="writeup-section">
            <h3>Screenshots with captions</h3>
            <figure>
                <img src="../assets/images/nmap.png" alt="Full nmap scan output showing 23 open ports on Metasploitable2">
                <figcaption>Full nmap scan output showing 23 open ports on Metasploitable2.</figcaption>
            </figure>
            <figure>
                <img src="../assets/images/port_21.png" alt="nmap service detection on port 21 showing vsftpd 2.3.4 with anonymous FTP login allowed">
                <figcaption>Port 21 vsftpd 2.3.4 with anonymous FTP login allowed.</figcaption>
            </figure>
            <figure>
                <img src="../assets/images/port_23.png" alt="nmap output on port 23 showing Linux telnetd running an unencrypted remote access service">
                <figcaption>Port 23 Telnet — unencrypted remote access protocol.</figcaption>
            </figure>
            <figure>
                <img src="../assets/images/port_1534-1099.png" alt="nmap output for ports 1099 and 1524 showing Java RMI registry and Metasploitable root bindshell">
                <figcaption>Port 1099 Java RMI and Port 1524 open root bindshell.</figcaption>
            </figure>
            <figure>
                <img src="../assets/images/port_3306_and_5432.png" alt="nmap output for ports 3306 and 5432 showing MySQL and PostgreSQL databases exposed to the network">
                <figcaption>Ports 3306 MySQL and 5432 PostgreSQL exposed directly to network.</figcaption>
            </figure>
        </div>

        <nav class="writeup-nav">
            <span></span>
            <a href="writeup-02.html">Next: Hydra Credential Brute Force →</a>
        </nav>
    </main>

    <footer>
        <p><a href="https://github.com/Jellybeansontoasties">GitHub</a> | Built on Arch Linux</p>
    </footer>
</body>
</html>
