<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Network scanning writeup: nmap reconnaissance against Metasploitable 2, Wazuh Rule 40101 detection, and defender takeaways.">
    <title>Network Scanning with nmap | jellybeansontoasties Home Lab</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <nav>
        <ul>
            <li><a href="../index.html">Home</a></li>
            <li><a href="../about.html">About</a></li>
            <li><a href="../lab-setup.html">Lab Setup</a></li>
            <li><a href="writeup-01.html">Writeups</a></li>
            <li><a href="https://github.com/Jellybeansontoasties">GitHub</a></li>
        </ul>
    </nav>

    <main>
        <h1>Network Scanning with nmap</h1>
        <p class="tagline">Reconnaissance scan against Metasploitable 2 (192.168.100.20) from Kali (192.168.100.10)</p>

        <div class="writeup-section">
            <h3>Objective</h3>
            <p>Perform reconnaissance against the victim host to identify open ports, running services, and operating system information. The goal is to build a map of attack surface before attempting exploitation.</p>
        </div>

        <div class="writeup-section">
            <h3>Tools used</h3>
            <p>nmap</p>
        </div>

        <div class="writeup-section">
            <h3>Command used</h3>
            <pre><code>nmap -sV -sC -O 192.168.100.20 -oN scan_results.txt</code></pre>
        </div>

        <div class="writeup-section">
            <h3>Expected output</h3>
            <div class="screenshot-placeholder">Screenshot: nmap scan output (ports, versions, OS guess)</div>
            <p>Here is the output of the nmap scan:</p>
            <pre><code>
            owokali@owokali:~$ sudo nmap -sV -sC -O 192.168.100.20 -oN scan_results.txt
            [sudo] password for owokali: 
            Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-22 20:44 +0800
            mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
            Nmap scan report for 192.168.100.20
            Host is up (0.00072s latency).
            Not shown: 977 closed tcp ports (reset)
            PORT     STATE SERVICE     VERSION
            21/tcp   open  ftp         vsftpd 2.3.4
            |_ftp-anon: Anonymous FTP login allowed (FTP code 230)
            | ftp-syst: 
            |   STAT: 
            | FTP server status:
            |      Connected to 192.168.100.10
            |      Logged in as ftp
            |      TYPE: ASCII
            |      No session bandwidth limit
            |      Session timeout in seconds is 300
            |      Control connection is plain text
            |      Data connections will be plain text
            |      vsFTPd 2.3.4 - secure, fast, stable
            |_End of status
            22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
            | ssh-hostkey: 
            |   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
            |_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
            23/tcp   open  telnet      Linux telnetd
            25/tcp   open  smtp        Postfix smtpd
            |_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
            | ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
            | Not valid before: 2010-03-17T14:07:45
            |_Not valid after:  2010-04-16T14:07:45
            | sslv2: 
            |   SSLv2 supported
            |   ciphers: 
            |     SSL2_RC4_128_EXPORT40_WITH_MD5
            |     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
            |     SSL2_RC4_128_WITH_MD5
            |     SSL2_DES_64_CBC_WITH_MD5
            |     SSL2_DES_192_EDE3_CBC_WITH_MD5
            |_    SSL2_RC2_128_CBC_WITH_MD5
            |_ssl-date: 2026-02-22T12:45:06+00:00; -1s from scanner time.
            53/tcp   open  domain      ISC BIND 9.4.2
            | dns-nsid: 
            |_  bind.version: 9.4.2
            80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
            |_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
            |_http-title: Metasploitable2 - Linux
            111/tcp  open  rpcbind     2 (RPC #100000)
            |_rpcinfo: ERROR: Script execution failed (use -d to debug)
            139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
            445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
            512/tcp  open  exec        netkit-rsh rexecd
            513/tcp  open  login       OpenBSD or Solaris rlogind
            514/tcp  open  shell       Netkit rshd
            1099/tcp open  java-rmi    GNU Classpath grmiregistry
            1524/tcp open  bindshell   Metasploitable root shell
            2049/tcp open  nfs         2-4 (RPC #100003)
            2121/tcp open  ftp         ProFTPD 1.3.1
            3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
            | mysql-info: 
            |   Protocol: 10
            |   Version: 5.0.51a-3ubuntu5
            |   Thread ID: 8
            |   Capabilities flags: 43564
            |   Some Capabilities: Support41Auth, SupportsTransactions, SwitchToSSLAfterHandshake, Speaks41ProtocolNew, ConnectWithDatabase, SupportsCompression, LongColumnFlag
            |   Status: Autocommit
            |_  Salt: M.>/m[]CvKP1C<E$"{hz
            5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
            |_ssl-date: 2026-02-22T12:45:06+00:00; -1s from scanner time.
            | ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
            | Not valid before: 2010-03-17T14:07:45
            |_Not valid after:  2010-04-16T14:07:45
            5900/tcp open  vnc         VNC (protocol 3.3)
            | vnc-info: 
            |   Protocol version: 3.3
            |   Security types: 
            |_    VNC Authentication (2)
            6000/tcp open  X11         (access denied)
            6667/tcp open  irc         UnrealIRCd
            8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
            |_ajp-methods: Failed to get a valid response for the OPTION request
            8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
            |_http-favicon: Apache Tomcat
            |_http-server-header: Apache-Coyote/1.1
            |_http-title: Apache Tomcat/5.5
            MAC Address: 52:54:00:8A:94:92 (QEMU virtual NIC)
            Device type: general purpose
            Running: Linux 2.6.X
            OS CPE: cpe:/o:linux:linux_kernel:2.6
            OS details: Linux 2.6.9 - 2.6.33
            Network Distance: 1 hop
            Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

            Host script results:
            | smb-os-discovery: 
            |   OS: Unix (Samba 3.0.20-Debian)
            |   Computer name: metasploitable
            |   NetBIOS computer name: 
            |   Domain name: localdomain
            |   FQDN: metasploitable.localdomain
            |_  System time: 2026-02-22T07:44:58-05:00
            |_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
            |_clock-skew: mean: 1h14m59s, deviation: 2h30m00s, median: -1s
            | smb-security-mode: 
            |   account_used: guest
            |   authentication_level: user
            |   challenge_response: supported
            |_  message_signing: disabled (dangerous, but default)
            |_smb2-time: Protocol negotiation failed (SMB2)

            OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
            Nmap done: 1 IP address (1 host up) scanned in 21.92 seconds
            </code></pre>
        </div>

        <div class="writeup-section">
            <h3>Findings</h3>
            <p>Open ports and services discovered (placeholder): multiple services including FTP, SSH, Telnet, HTTP, Samba, and others. Version detection and default scripts reveal software versions and potential misconfigurations. OS detection suggests the target is Linux. These findings inform which attack vectors to try next.</p>
        </div>

        <div class="writeup-section">
            <h3>Wazuh Alert</h3>
            <p><strong>Rule 40101</strong> — Network scan detected. The SIEM detected the reconnaissance activity from the Kali host (192.168.100.10) targeting the victim. This rule fires on port-scanning behavior and helps blue teams identify pre-attack enumeration.</p>
        </div>

        <div class="writeup-section">
            <h3>Defender Takeaway</h3>
            <p>Treat scan detection as a high-priority signal: reconnaissance often precedes exploitation. Correlate with other events (e.g., follow-up connection attempts). Reduce exposure by disabling unnecessary services and keeping only required ports open. Use network segmentation so critical assets are not in the same segment as internet-facing or lab systems.</p>
        </div>

        <nav class="writeup-nav">
            <span></span>
            <a href="writeup-02.html">Next: SSH Brute Force with Hydra →</a>
        </nav>
    </main>

    <footer>
        <p><a href="https://github.com/Jellybeansontoasties">GitHub</a> | Built on Arch Linux</p>
    </footer>
</body>
</html>
