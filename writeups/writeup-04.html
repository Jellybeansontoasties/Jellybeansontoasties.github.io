<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Privilege escalation writeup on Metasploitable: from msfadmin to root, Wazuh Rule 5902, defender takeaways.">
    <title>Privilege Escalation on Metasploitable | jellybeansontoasties Home Lab</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <nav>
        <ul>
            <li><a href="../index.html">Home</a></li>
            <li><a href="../about.html">About</a></li>
            <li><a href="../lab-setup.html">Lab Setup</a></li>
            <li><a href="writeup-01.html">Writeups</a></li>
            <li><a href="https://github.com/Jellybeansontoasties">GitHub</a></li>
        </ul>
    </nav>

    <main>
        <h1>Privilege Escalation on Metasploitable</h1>
        <p class="tagline">Escalate from msfadmin to root after gaining initial shell access</p>

        <div class="writeup-section">
            <h3>Objective</h3>
            <p>After obtaining a low-privilege shell (e.g. msfadmin), escalate to root using local enumeration (SUID binaries, kernel exploits, misconfigurations). This demonstrates why principle of least privilege and hardening matter even after initial compromise.</p>
        </div>

        <div class="writeup-section">
            <h3>Tools used</h3>
            <p>Metasploit post modules (e.g. local_exploit_suggester), manual enumeration (find, etc.)</p>
        </div>

        <div class="writeup-section">
            <h3>Approach</h3>
            <ul>
                <li>Run the <code>local_exploit_suggester</code> post module from Metasploit to get suggested local exploits.</li>
                <li>Enumerate SUID binaries: <code>find / -perm -4000 2>/dev/null</code></li>
                <li>Exploit a vulnerable SUID binary or kernel weakness (e.g. documented CVE for the target OS) to obtain root shell.</li>
            </ul>
            <pre><code>find / -perm -4000 2>/dev/null</code></pre>
        </div>

        <div class="writeup-section">
            <h3>Expected output</h3>
            <div class="screenshot-placeholder">Screenshot: root shell or id showing uid=0(root)</div>
        </div>

        <div class="writeup-section">
            <h3>Findings</h3>
            <p>Root shell obtained (placeholder): escalation was achieved via a vulnerable SUID binary or kernel exploit. Document the exact vector (e.g. binary name, CVE) and the command or module used. Full root access allows persistence, credential harvesting, and complete system control.</p>
        </div>

        <div class="writeup-section">
            <h3>Wazuh Alert</h3>
            <p><strong>Rule 5902</strong> — su/sudo by non-root user, or privilege change event. The SIEM detected a privilege escalation (e.g. su to root or execution of setuid binary resulting in root). This helps blue teams spot post-compromise escalation activity.</p>
        </div>

        <div class="writeup-section">
            <h3>Defender Takeaway</h3>
            <p>Apply principle of least privilege: limit sudo access and remove unnecessary SUID bits. Audit SUID binaries regularly (<code>find / -perm -4000</code>) and remove or replace risky ones. Harden sudoers and avoid NOPASSWD for sensitive commands. Monitor for su/sudo and privilege changes (e.g. Rule 5902) and correlate with initial access events. Keep systems patched to reduce kernel/local exploit options.</p>
        </div>

        <nav class="writeup-nav">
            <a href="writeup-03.html">← Previous: Reverse Shell Payload with msfvenom</a>
            <span></span>
        </nav>
    </main>

    <footer>
        <p><a href="https://github.com/Jellybeansontoasties">GitHub</a> | Built on Arch Linux</p>
    </footer>
</body>
</html>
